import xmltodict
import json
import os
import sys

def jsonToXML(json_str):

    xml_str = ''
    if type(json_str) == dict:
        dic = json_str
    else:
        dic = json.loads(json_str)
    try:
        xml_str = xmltodict.unparse(dic, encoding='utf-8')  # 示例字典字符串下这段代码会报错
    except Exception as e:
        xml_str = xmltodict.unparse({'request': dic}, encoding='utf-8')  # request可根据需求修改，目的是为XML字符串提供顶层标签
    finally:
        return xml_str

# print(jsonToXML('''{"s": {"@n": "1203", "w": [{"@c5": "ITJ", "@hw": "yeah", "@pos": "INTERJ", "#text": "Yeah"}, {"@c5": "PNP", "@hw": "it", "@pos": "PRON", "#text": "it"}, {"@c5": "VVZ", "@hw": "say", "@pos": "VERB", "#text": "says"}, {"@c5": "NN2", "@hw": "roman", "@pos": "SUBST", "#text": "Romans"}, {"@c5": "CRD", "@hw": "ten", "@pos": "ADJ", "#text": "ten"}, {"@c5": "NN1-VVB", "@hw": "verse", "@pos": "SUBST", "#text": "verse"}, {"@c5": "CRD", "@hw": "thirteen", "@pos": "ADJ", "#text": "thirteen"}, {"@c5": "PRP", "@hw": "for", "@pos": "PREP", "#text": "for"}, {"@c5": "PNI", "@hw": "everyone", "@pos": "PRON", "#text": "everyone"}, {"@c5": "PNQ", "@hw": "who", "@pos": "PRON", "#text": "who"}, {"@c5": "VVZ", "@hw": "call", "@pos": "VERB", "#text": "calls"}, {"@c5": "PRP", "@hw": "on", "@pos": "PREP", "#text": "on"}, {"@c5": "AT0", "@hw": "the", "@pos": "ART", "#text": "the"}, {"@c5": "NN1", "@hw": "name", "@pos": "SUBST", "#text": "name"}, {"@c5": "PRF", "@hw": "of", "@pos": "PREP", "#text": "of"}, {"@c5": "NP0", "@hw": "jehovah", "@pos": "SUBST", "#text": "Jehovah"}, {"@c5": "VM0", "@hw": "will", "@pos": "VERB", "#text": "will"}, {"@c5": "VBI", "@hw": "be", "@pos": "VERB", "#text": "be"}, {"@c5": "VVN", "@hw": "save", "@pos": "VERB", "#text": "saved"}, {"@c5": "AV0", "@hw": "however", "@pos": "ADV", "#text": "however"}, {"@c5": "AVQ", "@hw": "how", "@pos": "ADV", "#text": "how"}, {"@c5": "VM0", "@hw": "will", "@pos": "VERB", "#text": "will"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VVI", "@hw": "call", "@pos": "VERB", "#text": "call"}, {"@c5": "PRP", "@hw": "on", "@pos": "PREP", "#text": "on"}, {"@c5": "PNP", "@hw": "he", "@pos": "PRON", "#text": "him"}, {"@c5": "CJS", "@hw": "if", "@pos": "CONJ", "#text": "if"}, {"@c5": "PRP", "@hw": "in", "@pos": "PREP", "#text": "in"}, {"@c5": "PNP", "@hw": "he", "@pos": "PRON", "#text": "him"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VM0", "@hw": "would", "@pos": "VERB", "#text": "'d"}, {"@c5": "XX0", "@hw": "not", "@pos": "ADV", "#text": "not"}, {"@c5": "VVI", "@hw": "put", "@pos": "VERB", "#text": "put"}, {"@c5": "NN1", "@hw": "faith", "@pos": "SUBST", "#text": "faith"}, {"@c5": "AVQ", "@hw": "how", "@pos": "ADV", "#text": "how"}, {"@c5": "PRP", "@hw": "in", "@pos": "PREP", "#text": "in"}, {"@c5": "NN1", "@hw": "turn", "@pos": "SUBST", "#text": "turn"}, {"@c5": "VM0", "@hw": "will", "@pos": "VERB", "#text": "will"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VVI", "@hw": "put", "@pos": "VERB", "#text": "put"}, {"@c5": "NN1", "@hw": "faith", "@pos": "SUBST", "#text": "faith"}, {"@c5": "PRP", "@hw": "in", "@pos": "PREP", "#text": "in"}, {"@c5": "PNP", "@hw": "he", "@pos": "PRON", "#text": "him"}, {"@c5": "CJS", "@hw": "if", "@pos": "CONJ", "#text": "if"}, {"@c5": "PNP", "@hw": "he", "@pos": "PRON", "#text": "him"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VHB", "@hw": "have", "@pos": "VERB", "#text": "'ve"}, {"@c5": "XX0", "@hw": "not", "@pos": "ADV", "#text": "not"}, {"@c5": "VVN", "@hw": "hear", "@pos": "VERB", "#text": "heard"}, {"@c5": "AVQ", "@hw": "how", "@pos": "ADV", "#text": "how"}, {"@c5": "PRP", "@hw": "in", "@pos": "PREP", "#text": "in"}, {"@c5": "NN1", "@hw": "turn", "@pos": "SUBST", "#text": "turn"}, {"@c5": "VM0", "@hw": "will", "@pos": "VERB", "#text": "will"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VVI", "@hw": "hear", "@pos": "VERB", "#text": "hear"}, {"@c5": "PRP", "@hw": "without", "@pos": "PREP", "#text": "without"}, {"@c5": "PNI", "@hw": "someone", "@pos": "PRON", "#text": "someone"}, {"@c5": "TO0", "@hw": "to", "@pos": "PREP", "#text": "to"}, {"@c5": "VVI", "@hw": "preach", "@pos": "VERB", "#text": "preach"}, {"@c5": "AVQ", "@hw": "how", "@pos": "ADV", "#text": "how"}, {"@c5": "PRP", "@hw": "in", "@pos": "PREP", "#text": "in"}, {"@c5": "NN1", "@hw": "turn", "@pos": "SUBST", "#text": "turn"}, {"@c5": "VM0", "@hw": "will", "@pos": "VERB", "#text": "will"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VVI", "@hw": "preach", "@pos": "VERB", "#text": "preach"}, {"@c5": "CJS", "@hw": "unless", "@pos": "CONJ", "#text": "unless"}, {"@c5": "PNP", "@hw": "they", "@pos": "PRON", "#text": "they"}, {"@c5": "VHB", "@hw": "have", "@pos": "VERB", "#text": "'ve"}, {"@c5": "VBN", "@hw": "be", "@pos": "VERB", "#text": "been"}, {"@c5": "VVN", "@hw": "send", "@pos": "VERB", "#text": "sent"}, {"@c5": "AV0", "@hw": "forth", "@pos": "ADV", "#text": "forth"}, {"@c5": "AV0", "@hw": "just", "@pos": "ADV", "#text": "just"}, {"@c5": "CJS", "@hw": "as", "@pos": "CONJ", "#text": "as"}, {"@c5": "PNP", "@hw": "it", "@pos": "PRON", "#text": "it"}, {"@c5": "VBZ", "@hw": "be", "@pos": "VERB", "#text": "is"}, {"@c5": "VVN-AJ0", "@hw": "write", "@pos": "VERB", "#text": "written"}, {"@c5": "AVQ", "@hw": "how", "@pos": "ADV", "#text": "how"}, {"@c5": "VVN", "@hw": "come", "@pos": "VERB", "#text": "come"}, {"@c5": "PNP", "@hw": "we", "@pos": "PRON", "#text": "we"}, {"@c5": "VBB", "@hw": "be", "@pos": "VERB", "#text": "are"}, {"@c5": "PRP", "@hw": "at", "@pos": "PREP", "#text": "at"}, {"@c5": "AT0", "@hw": "the", "@pos": "ART", "#text": "the"}, {"@c5": "NN2", "@hw": "foot", "@pos": "SUBST", "#text": "feet"}, {"@c5": "PRF", "@hw": "of", "@pos": "PREP", "#text": "of"}, {"@c5": "DT0", "@hw": "those", "@pos": "ADJ", "#text": "those"}, {"@c5": "PNQ", "@hw": "who", "@pos": "PRON", "#text": "who"}, {"@c5": "VVB", "@hw": "declare", "@pos": "VERB", "#text": "declare"}, {"@c5": "AJ0", "@hw": "good", "@pos": "ADJ", "#text": "good"}, {"@c5": "NN1", "@hw": "news", "@pos": "SUBST", "#text": "news"}, {"@c5": "PRF", "@hw": "of", "@pos": "PREP", "#text": "of"}, {"@c5": "AJ0", "@hw": "good", "@pos": "ADJ", "#text": "good"}, {"@c5": "NN2", "@hw": "thing", "@pos": "SUBST", "#text": "things"}, {"@c5": "AV0", "@hw": "well", "@pos": "ADV", "#text": "well"}, {"@c5": "DT0", "@hw": "that", "@pos": "ADJ", "#text": "that"}, {"@c5": "VBZ", "@hw": "be", "@pos": "VERB", "#text": "'s"}, {"@c5": "AV0", "@hw": "more", "@pos": "ADV", "#text": "more"}, {"@c5": "CJC", "@hw": "or", "@pos": "CONJ", "#text": "or"}, {"@c5": "AV0", "@hw": "less", "@pos": "ADV", "#text": "less"}, {"@c5": "DTQ", "@hw": "what", "@pos": "PRON", "#text": "what"}, {"@c5": "PNP", "@hw": "we", "@pos": "PRON", "#text": "we"}, {"@c5": "VBD", "@hw": "be", "@pos": "VERB", "#text": "were"}, {"@c5": "VVG", "@hw": "say", "@pos": "VERB", "#text": "saying"}, {"@c5": "VBZ", "@hw": "be", "@pos": "VERB", "#text": "is"}, {"@c5": "XX0", "@hw": "not", "@pos": "ADV", "#text": "n't"}, {"@c5": "PNP", "@hw": "it", "@pos": "PRON", "#text": "it"}], "c": [{"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": ","}, {"@c5": "PUN", "#text": "?"}], "shift": [{"@new": "reading"}, null, {"@new": "reading"}, null], "trunc": {"w": {"@c5": "UNC", "@hw": "every", "@pos": "UNC", "#text": "every"}}}}
# '''))

g = os.walk("/Users/zhoujie/Desktop/logistic_reg_project/all_big_data/clean_data_json_test/JSON")
list_xml = []
for path, dir_list, file_list in g:
    for file in file_list:
        file_path = os.path.join(path, file)
        print(file_path)
        xml_path = file_path.replace(".json", ".xml")
        with open(file_path) as f:
            js_list = f.read().split("\n")
            for js in js_list:
                js_to_xml = jsonToXML(js) + "\n"
                with open(xml_path,"a+") as q:
                    q.write(js_to_xml)

